<html>

<head>
    <meta charset="utf-8" />
    <title>generic database</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

    <script lang="js">
        /*function getAll() {
            $.get("http://127.0.01.:8080/persons/all", {},
                function(result) {
                    alert(JSON.stringify(result));
                });
        }*/

        function getOne() {
            let key = document.getElementById("key").value;
            $.get('http://127.0.0.1:8080/persons/search', {
                    "id": key
                },
                function(result) {
                    let table = document.getElementById("results");
                    table.innerHTML = result;

                });
        }

         function getAll() {
           $.get('http://127.0.0.1:8080/persons/all',
                 {},
               function(result) {
                   let table = document.getElementById("results");
                   table.innerHTML = result;
               });
        }

        function save(id){
          let it = document.getElementById("key").value;
          id=it;
            $.post('http://127.0.0.1:8080/persons/save',
                   {'id':id /*,
                   'name':document.getElementById(id+"_name").value,
                   'address':document.getElementById(id+"_address").value,
                    'tel':document.getElementById(id+"_tel").value*/
                   }, function(result){alert("Saving " + id + ": " + result)});
        }



        function createTableRow(p) {

            console.log(p);
            let tableRow = document.createElement("tr");

            for (var _id in p);

            let tableData_id = document.createElement("td");
            let textNode_id = document.createTextNode(_id);
            tableData_id.appendChild(textNode_id);
            tableRow.appendChild(tableData_id);

            let tableData_name = document.createElement("td");
            let input_name = document.createElement('input');
            input_name.setAttribute("type","text");
            input_name.setAttribute("size", "30");
            input_name.setAttribute("id",  _id + "_name");
            input_name.setAttribute("value", p[_id].name);
            let textNode_name = document.createTextNode(p[_id].name);
            tableData_name.appendChild(input_name);
            tableRow.appendChild(tableData_name);

            let tableData_address = document.createElement("td");
            let textNode_address = document.createTextNode(p[_id].address);
            let input_address = document.createElement('input');
            input_address.setAttribute("type","text");
            input_address.setAttribute("size", "30");
            input_address.setAttribute("id",  _id + "_address");
            input_address.setAttribute("value", p[_id].address);
            tableData_address.appendChild(input_address);
            tableRow.appendChild(tableData_address);

            let tableData_tel = document.createElement("td");
            let textNode_tel = document.createTextNode(p[_id].tel);
            let input_tel = document.createElement('input');
            input_tel.setAttribute("type","text");
            input_tel.setAttribute("size", "30");
            input_tel.setAttribute("id", _id + "_tel");
            input_tel.setAttribute("value", p[_id].tel);
            tableData_tel.appendChild(input_tel);
            tableRow.appendChild(tableData_tel);

            let tableData_save= document.createElement("td");
            let input_save = document.createElement("input");
            input_save.setAttribute("type","button");
            input_save.setAttribute("value","Save");
            input_save.setAttribute("onclick","save");
            tableData_save.appendChild(input_save);
            tableRow.appendChild(tableData_save);

            return tableRow;
        }

    </script>

</head>

<body>
    <h1>database for persons</h1>

    <table>
        <tr>
            <td>ID :</td>
            <td><input type="text" id="key" size="20"></td>

        </tr>
        <tr>
            <td><input type="button" value="all" onclick="getAll()"></td>
            <td><input type="button" value="search" onclick="getOne()"></td>
        </tr>
        <tr>
          <td><input type="button" value="save" onclick="save()"></td>
        </tr>
    </table>
    <hr>
    <table id="results" cellpadding="10px" border="2">
        <tr id="results_header">
            <th>ID</th>
            <th>name</th>
            <th>address</th>
            <th>telephone</th>
        </tr>

    </table>
</body>

</html>
