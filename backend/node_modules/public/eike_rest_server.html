<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <title>Search</title>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

    <script type="text/javascript">
        function sendAjax() {
          $.ajax({
            type: 'GET',
            url: 'http://127.0.0.1:8063/MyApp/search',
            data: {
              'key': document.getElementById('key').value
            },
            async: true,
            dataType: 'json',
            success: function(data, textStatus, jqXHR) {
                 var obj = JSON.parse(jqXHR.responseText);
                 console.log(obj);
                 document.getElementById('name').value = obj.name;
                 document.getElementById('tel').value = obj.tel;
            },
            error: function(jqXHR, textStatus, errorThrown) {
              console.log(textStatus + ": " + errorThrown);
            },
            timeout: 5000

          });
        }

        function sendAjaxC() {
            $.ajax({
                type: 'POST',
                url: 'http://127.0.0.1:8080/appname/users/' + document.getElementById('key').value,
                data: {
                    key : document.getElementById('key').value,
                    tel : document.getElementById('tel').value
                },
                async: true,
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    var obj = JSON.parse(jqXHR.responseText);
                    console.log(obj);
                    document.getElementById('name').value = "Data created!";
                    document.getElementById('tel').value = "Data created!";
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.log(textStatus + ": " + errorThrown);
                },
                timeout: 5000

            });
        }

        function sendAjaxR() {
            $.ajax({
                type: 'GET',
                url: 'http://127.0.0.1:8080/appname/users/' + document.getElementById('key').value,
                data: {
                    'key': document.getElementById('key').value
                },
                async: true,
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    var obj = JSON.parse(jqXHR.responseText);
                    console.log(obj);
                    document.getElementById('name').value = obj.name;
                    document.getElementById('tel').value = obj.tel;
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.log(textStatus + ": " + errorThrown);
                },
                timeout: 5000

            });
        }

        function sendAjaxU() {
            $.ajax({
                type: 'PUT',
                url: 'http://127.0.0.1:8080/appname/users/' + document.getElementById('key').value,
                data: {
                    'key': document.getElementById('key').value
                },
                async: true,
                dataType: 'json',
                success: function (data, textStatus, jqXHR) {
                    var obj = JSON.parse(jqXHR.responseText);
                    console.log(obj);
                    document.getElementById('name').value = "Data updated";
                    document.getElementById('tel').value = "Data updated";
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.log(textStatus + ": " + errorThrown);
                },
                timeout: 5000

            });
        }

        function sendAjaxD() {
            $.ajax({
                type: 'DELETE',
                url: 'http://127.0.0.1:8080/appname/users/' + document.getElementById('key').value,
                data: {
                    'key': document.getElementById('key').value
                },
                async: true,
                dataType: 'json',
                success: function () {
                    document.getElementById('name').value = "Data deleted";
                    document.getElementById('tel').value = "Data deleted";
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.log(textStatus + ": " + errorThrown);
                },
                timeout: 5000

            });
        }


    </script>
</head>

<body>
    <h1>Database Change: </h1>
    <table>
        <tr>
            <td>
                Key:
            </td>
            <td>
                <input type="text" size="40" id="key" />
            </td>
        </tr>
        <tr>
            <td>Name: </td>
            <td><input type="text" size="40" id="name" /> </td>
        </tr>
        <tr>
            <td>TelNr: </td>
            <td><input type="text" id="tel" size="40"></td>
        </tr>
            
    </table>
    <button type="button" onclick="javascript: sendAjaxC();">Create</button>
    <button type="button" onclick="javascript: sendAjaxR();">Read</button>
    <button type="button" onclick="javascript: sendAjaxU();">Update</button>
    <button type="button" onclick="javascript: sendAjaxD();">Delete</button>

</body>

</html>
